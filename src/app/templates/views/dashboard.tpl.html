<div id="pm_settings">
    <ng-include src="'templates/partials/menu.settings.tpl.html'"></ng-include>
    <div class="settings" pt-height>
        <pre>{{ plans | json }}</pre>
        <pre>{{ subscription | json }}</pre>
        <div class="row">
            <section class="setting pm_form" ng-if="organization !== null">
                <legend>{{ 'OVERVIEW' | translate }}</legend>
                <div class="well">
                    <table class="pm_table plain" id="tableOverview">
                        <tr>
                            <th>{{ 'ORGANIZATION' | translate }}:</th>
                            <td>
                                <strong>{{ organization.DisplayName }}</strong>
                            </td>
                            <td>&nbsp;</td>
                        </tr>
                        <tr>
                            <th>{{ 'DOMAINS' | translate }}:</th>
                            <td>
                                <strong>{{ organization.UsedDomains }} {{ 'OF' | translate }} {{ organization.MaxDomains }} {{ 'USED' | translate }}</strong>
                            </td>
                            <td class='text-right'>
                                <span>
                                    <a ui-sref="secured.domains">{{ 'MANAGE' | translate }}</a>
                                </span>
                            </td>
                        </tr>
                        <tr>
                            <th>{{ 'ADDRESSES' | translate }}:</th>
                            <td>
                                <strong>{{ organization.UsedAddresses }} {{ 'OF' | translate }} {{ organization.MaxAddresses }} {{ 'USED' | translate }}</strong>
                            </td>
                            <td class='text-right'>
                                <span>
                                    <a ui-sref="secured.domains">{{ 'MANAGE' | translate }}</a>
                                </span>
                            </td>
                        </tr>
                        <tr>
                            <th>{{ 'USERS' | translate }}:</th>
                            <td>
                                <strong>{{ organization.UsedMembers }} {{ 'OF' | translate }} {{ organization.MaxMembers }} {{ 'USED' | translate }}</strong>
                            </td>
                            <td class='text-right'>
                                <span>
                                    <a ui-sref="secured.members">{{ 'MANAGE' | translate }}</a>
                                </span>
                            </td>
                        </tr>
                        <tr>
                            <th>{{ 'STORAGE' | translate }}:</th>
                            <td>
                                <strong>{{ percentage() }}% {{ 'USED' | translate }}</strong>
                            </td>
                            <td>&nbsp;</td>
                        </tr>
                        <tr class="storage">
                            <td>&nbsp;</td>
                            <td colspan="2" rowspan="2">
                                <div class="usage">
                                    <em class="used">{{ organization.UsedSpace | humanSize }}</em>
                                    <em class="bar">
                                        <div class="amount" style="width: {{ percentage() }}%"></div>
                                    </em>
                                    <em class="total">{{ organization.MaxSpace | humanSize }}</em>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>&nbsp;</td>
                        </tr>
                    </table>
                </div>
            </section>
            <section class="setting pm_form pull-right" ng-if="subscription.Name !== 'free'">
                <legend>{{ 'CURRENT_SUBSCRIPTION' | translate }}</legend>
                <div class="well">
                    <table class="pm_table plain" id="tableSubscription">
                        <tr>
                            <th>{{ 'PLAN' | translate }}: </th>
                            <td colspan="2">
                                <strong>{{ subscription.Name | capitalize }} {{ 'PLAN' | translate }}</strong>
                            </td>
                        </tr>
                        <tr>
                            <th>{{ 'DOMAINS' | translate }}:</th>
                            <td colspan="2">
                                <strong>{{ organization.MaxDomains }}</strong>
                            </td>
                        </tr>
                        <tr>
                            <th>{{ 'ADDRESSES' | translate }}:</th>
                            <td colspan="2">
                                <strong>{{ organization.MaxAddresses }}</strong>
                            </td>
                        </tr>
                        <tr>
                            <th>{{ 'STORAGE' | translate }}:</th>
                            <td colspan="2">
                                <strong>{{ organization.MaxSpace | humanSize }}</strong>
                            </td>
                        </tr>
                        <tr>
                            <th>{{ 'USERS' | translate }}:</th>
                            <td colspan="2">
                                <strong>{{ organization.MaxMembers }}</strong>
                            </td>
                        </tr>
                        <tr>
                            <th>{{ 'PRICE' | translate }}: </th>
                            <td colspan="2">
                                <strong>{{ subscription.Amount / 100 | currency: subscription.Currency }}</strong>
                            </td>
                        </tr>
                        <tr>
                            <th>{{ 'BILLING' | translate }}:</th>
                            <td colspan="2">
                                <strong ng-show="currentBillingCycle === 1">{{ 'MONTHLY' | translate }}</strong>
                                <strong ng-show="currentBillingCycle === 12">{{ 'YEARLY' | translate }}</strong>
                            </td>
                        </tr>
                        <tr>
                            <th>{{ 'DURATION' | translate }}:</th>
                            <td colspan="2">
                                <strong>{{ subscription.PeriodStart * 1000 | date }} - {{ subscription.PeriodEnd * 1000 | date }}</strong>
                            </td>
                        </tr>
                        <tr>
                            <th>{{ 'PAYMENT' | translate }}:</th>
                            <td>
                                <strong>
                                    <i class="fa fa-credit-card"></i> {{ 'CREDIT_CARD' | translate }}
                                </strong>
                            </td>
                            <td class="text-right">
                                <a href="#" ng-click="card()" pt-tooltip="{{ 'PAYMENT_INFORMATION' | translate }}">{{ 'EDIT' | translate }}</a>
                            </td>
                        </tr>
                    </table>
                </div>
            </section>
        </div>

        <div class="row">
            <section class="setting pm_form full" id="plans">
                <legend>{{ 'PLANS' | translate }}</legend>
                <header>
                    <a href="https://protonmail.com/support/knowledge-base/manage-your-plan" class="pm_button link pull-right">Learn how to manage your ProtonMail plan.</a>
                    <div class="group">
                        <label>{{ 'CURRENCY' | translate }}</label>
                        <div class="pm_buttons">
                            <a href="#" ng-click="changeCurrency('EUR')" ng-class="{'active': currentCurrency === 'EUR'}">EUR</a>
                            <a href="#" ng-click="changeCurrency('USD')" ng-class="{'active': currentCurrency === 'USD'}" class="divider">USD</a>
                            <a href="#" ng-click="changeCurrency('CHF')" ng-class="{'active': currentCurrency === 'CHF'}" class="divider">CHF</a>
                        </div>
                    </div>
                    <div class="group">
                        <label>{{ 'BILLING' | translate }}</label>
                        <div class="pm_buttons">
                            <a href="#" ng-click="changeCycle(1)" ng-class="{'active': currentCycle === 1}">{{ 'MONTHLY' | translate }}</a>
                            <a href="#" ng-click="changeCycle(12)" ng-class="{'active': currentCycle === 12}" class="divider">{{ 'YEARLY' | translate }} <small class="text-green">{{ 'SAVE_20%' | translate }}</small></a>
                        </div>
                    </div>
                </header>
                <div class="pm_grid plans">
                    <div class="col-1-3" ng-repeat="plan in plans | filter: {Type: 1} | orderBy: 'Amount'" ng-show="plan.display === true">
                        <div class="plan" ng-class="{'selected': plan.Name === subscription.Name}">
                            <header>{{ 'YOUR_CURRENT_PLAN' | translate }}</header>
                            <h3>{{ plan.Title }}</h3>
                            <ul class="features">
                                <li>
                                    <i class="fa fa-check"></i>
                                    <i class="fa fa-times"></i>
                                    <span class="pm_select" ng-show="plan.editable === true">
                                        <select ng-model="plan.Space" ng-options="option.label for option in spaceOptions"></select>
                                        <i class="fa fa-angle-down"></i>
                                    </span>
                                    <strong ng-show="plan.editable === false">{{ plan.MaxSpace | humanSize }}</strong> <strong>{{ 'STORAGE' | translate }}</strong>
                                    <span class="cost" ng-show="plan.Space.index * spaceAddon.Amount">
                                        <strong>{{ plan.Space.index * spaceAddon.Amount / 100 | currency: plan.Currency }}</strong>
                                    </span>
                                </li>
                                <li ng-class="{disabled: plan.MaxDomains === 0}">
                                    <i class="fa fa-check"></i>
                                    <i class="fa fa-times"></i>
                                    <span class="pm_select" ng-show="plan.editable === true">
                                        <select ng-model="plan.Domain" ng-options="option.label for option in domainOptions"></select>
                                        <i class="fa fa-angle-down"></i>
                                    </span>
                                    <strong ng-show="plan.editable === false">{{ plan.MaxDomains }}</strong> <strong>{{ 'CUSTOM_DOMAIN' | translate }}</strong>
                                    <span class="cost" ng-show="plan.Domain.index * domainAddon.Amount">
                                        <strong>{{ plan.Domain.index * domainAddon.Amount / 100 | currency: plan.Currency }}</strong>
                                    </span>
                                </li>
                                <li>
                                    <i class="fa fa-check"></i>
                                    <i class="fa fa-times"></i>
                                    <span class="pm_select" ng-show="plan.editable === true">
                                        <select ng-model="plan.Address" ng-options="option.label for option in addressOptions"></select>
                                        <i class="fa fa-angle-down"></i>
                                    </span>
                                    <strong ng-show="plan.editable === false">{{ plan.MaxAddresses }}</strong> <stong>{{ 'ADDRESS' | translate }}</strong>
                                    <span class="cost" ng-show="plan.Address.index * addressAddon.Amount">
                                        <strong>{{ plan.Address.index * addressAddon.Amount / 100 | currency: plan.Currency }}</strong>
                                    </span>
                                </li>
                                <!-- <li>
                                    <i class="fa fa-check"></i>
                                    <i class="fa fa-times"></i>
                                    <span class="pm_select" ng-show="plan.editable === true">
                                        <select ng-model="plan.Member" ng-options="option.label for option in memberOptions"></select>
                                        <i class="fa fa-angle-down"></i>
                                    </span>
                                    <strong>{{ plan.MaxMembers }} {{ 'MEMBERS' | translate }}</strong>
                                    <span class="cost" ng-show="plan.Member.value * memberAddon.Amount">
                                        <strong>{{ plan.Member.value * memberAddon.Amount / 100 | currency: plan.Currency }}</strong>
                                    </span>
                                </li> -->
                            </ul>
                            <div class="price">
                                <strong>{{ 'TOTAL' | translate }}:</strong>
                                <span ng-show="plan.Amount === 0">{{ 'FREE' | translate }}</span>
                                <span ng-show="plan.Amount > 0">
                                    {{ total(plan) / 100 | currency: plan.Currency }}
                                    <span ng-show="plan.Cycle === 1">{{ 'PER_MONTH' | translate }}</span>
                                    <span ng-show="plan.Cycle === 12">{{ 'PER_YEAR' | translate }}</span>
                                </span>
                            </div>
                            <div class="action">
                                <button type="button" ng-click="choose(plan)" class="pm_button primary">
                                    <strong>{{ 'CHOOSE_PLAN' | translate }}</strong>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>
